<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/e8febeb6730d7a7bce46.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e8febeb6730d7a7bce46.css" data-n-g=""/><link rel="preload" href="/_next/static/css/8189cb58e298e1a5e388.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8189cb58e298e1a5e388.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.c4db113d6ae1605f54bb.js" as="script"/><link rel="preload" href="/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.3017f9b6be27c667c533.js" as="script"/><link rel="preload" href="/_next/static/chunks/main-c129779407ff225e84bd.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-296f3014e90507873ea9.js" as="script"/><link rel="preload" href="/_next/static/chunks/1df474da.d95f8884482661656c51.js" as="script"/><link rel="preload" href="/_next/static/chunks/1bb37dfa4a3d16451abcd7ba6f75b92f45ed2736.23a21b264878a7c00596.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/%5Bid%5D-41af1dbfc4675f634447.js" as="script"/></head><body><div id="__next"><div class=".app"><div class="styles_header__2KtfL"><div class="styles_logo__KwRGz"><a href="/"><img alt="logo" src="/logo.svg"/></a></div></div><div class="content"></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"dir":"1290-hard-pinia","id":"1290","challenge":"hard","info":{"difficulty":"hard","title":"Pinia","tags":"this, vue","author":{"github":"g-plane","name":"Pig Fang"}},"prefix":"\u003c!--info-header-start--\u003e\u003ch1\u003ePinia \u003cimg src=\"https://img.shields.io/badge/-hard-de3d37\" alt=\"hard\"/\u003e \u003cimg src=\"https://img.shields.io/badge/-%23this-999\" alt=\"#this\"/\u003e \u003cimg src=\"https://img.shields.io/badge/-%23vue-999\" alt=\"#vue\"/\u003e\u003c/h1\u003e\u003cblockquote\u003e\u003cp\u003eby Pig Fang \u003ca href=\"https://github.com/g-plane\" target=\"_blank\"\u003e@g-plane\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\u003cp\u003e\u003ca href=\"https://tsch.js.org/1290/play\" target=\"_blank\"\u003e\u003cimg src=\"https://img.shields.io/badge/-Take%20the%20Challenge-3178c6?logo=typescript\u0026logoColor=white\" alt=\"Take the Challenge\"/\u003e\u003c/a\u003e \u003c/p\u003e\u003c!--info-header-end--\u003e\n\nCreate a type-level function whose types is similar to [Pinia](https://github.com/posva/pinia) library. You don't need to implement function actually, just adding types.\r\n\r\n### Overview\r\n\r\nThis function receive only one parameter whose type is an object. The object contains 4 properties:\r\n\r\n- `id` - just a string (required)\r\n- `state` - a function which will return an object as store's state (required)\r\n- `getters` - an object with methods which is similar to Vue's computed values or Vuex's getters, and details are below (optional)\r\n- `actions` - an object with methods which can do side effects and mutate state, and details are below (optional)\r\n\r\n### Getters\r\n\r\nWhen you define a store like this:\r\n\r\n```typescript\r\nconst store = defineStore({\r\n  // ...other required fields\r\n  getters: {\r\n    getSomething() {\r\n      return 'xxx'\r\n    }\r\n  }\r\n})\r\n```\r\n\r\nAnd you should use it like this:\r\n\r\n```typescript\r\nstore.getSomething\r\n```\r\n\r\ninstead of:\r\n\r\n```typescript\r\nstore.getSomething()  // error\r\n```\r\n\r\nAdditionally, getters can access state and/or other getters via `this`, but state is read-only.\r\n\r\n### Actions\r\n\r\nWhen you define a store like this:\r\n\r\n```typescript\r\nconst store = defineStore({\r\n  // ...other required fields\r\n  actions: {\r\n    doSideEffect() {\r\n      this.xxx = 'xxx'\r\n      return 'ok'\r\n    }\r\n  }\r\n})\r\n```\r\n\r\nUsing it is just to call it:\r\n\r\n```typescript\r\nconst returnValue = store.doSideEffect()\r\n```\r\n\r\nActions can return any value or return nothing, and it can receive any number of parameters with different types.\r\nParameters types and return type can't be lost, which means type-checking must be available at call side.\r\n\r\nState can be accessed and mutated via `this`. Getters can be accessed via `this` but they're read-only.\n\n\n\u003c!--info-footer-start--\u003e\u003cbr\u003e\u003ca href=\"../../README.md\" target=\"_blank\"\u003e\u003cimg src=\"https://img.shields.io/badge/-Back-grey\" alt=\"Back\"/\u003e\u003c/a\u003e \u003ca href=\"https://tsch.js.org/1290/answer\" target=\"_blank\"\u003e\u003cimg src=\"https://img.shields.io/badge/-Share%20your%20Solutions-teal\" alt=\"Share your Solutions\"/\u003e\u003c/a\u003e \u003ca href=\"https://tsch.js.org/1290/solutions\" target=\"_blank\"\u003e\u003cimg src=\"https://img.shields.io/badge/-Check%20out%20Solutions-de5a77?logo=awesome-lists\u0026logoColor=white\" alt=\"Check out Solutions\"/\u003e\u003c/a\u003e \u003c!--info-footer-end--\u003e","suffix":"import { Equal, Expect } from '@type-challenges/utils'\r\n\r\nconst store = defineStore({\r\n  id: '',\r\n  state: () =\u003e ({\r\n    num: 0,\r\n    str: '',\r\n  }),\r\n  getters: {\r\n    stringifiedNum() {\r\n      // @ts-expect-error\r\n      this.num += 1\r\n\r\n      return this.num.toString()\r\n    },\r\n    parsedNum() {\r\n      return parseInt(this.stringifiedNum)\r\n    },\r\n  },\r\n  actions: {\r\n    init() {\r\n      this.reset()\r\n      this.increment()\r\n    },\r\n    increment(step = 1) {\r\n      this.num += step\r\n    },\r\n    reset() {\r\n      this.num = 0\r\n\r\n      // @ts-expect-error\r\n      this.parsedNum = 0\r\n\r\n      return true\r\n    },\r\n    setNum(value: number) {\r\n      this.num = value\r\n    },\r\n  },\r\n})\r\n\r\n// @ts-expect-error\r\nstore.nopeStateProp\r\n// @ts-expect-error\r\nstore.nopeGetter\r\n// @ts-expect-error\r\nstore.stringifiedNum()\r\nstore.init()\r\n// @ts-expect-error\r\nstore.init(0)\r\nstore.increment()\r\nstore.increment(2)\r\n// @ts-expect-error\r\nstore.setNum()\r\n// @ts-expect-error\r\nstore.setNum('3')\r\nstore.setNum(3)\r\nconst r = store.reset()\r\n\r\ntype _tests = [\r\n  Expect\u003cEqual\u003ctypeof store.num, number\u003e\u003e,\r\n  Expect\u003cEqual\u003ctypeof store.str, string\u003e\u003e,\r\n  Expect\u003cEqual\u003ctypeof store.stringifiedNum, string\u003e\u003e,\r\n  Expect\u003cEqual\u003ctypeof store.parsedNum, number\u003e\u003e,\r\n  Expect\u003cEqual\u003ctypeof r, true\u003e\u003e\r\n]\n","content":"declare function defineStore(store: unknown): unknown\n"},"__N_SSG":true},"page":"/[id]","query":{"id":"1290-hard-pinia"},"buildId":"UhjACfgIYlGKTYHX6L_ZR","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-076e78994db3acc22a9f.js"></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.c4db113d6ae1605f54bb.js" async=""></script><script src="/_next/static/chunks/f6078781a05fe1bcb0902d23dbbb2662c8d200b3.3017f9b6be27c667c533.js" async=""></script><script src="/_next/static/chunks/main-c129779407ff225e84bd.js" async=""></script><script src="/_next/static/chunks/pages/_app-296f3014e90507873ea9.js" async=""></script><script src="/_next/static/chunks/1df474da.d95f8884482661656c51.js" async=""></script><script src="/_next/static/chunks/1bb37dfa4a3d16451abcd7ba6f75b92f45ed2736.23a21b264878a7c00596.js" async=""></script><script src="/_next/static/chunks/pages/%5Bid%5D-41af1dbfc4675f634447.js" async=""></script><script src="/_next/static/UhjACfgIYlGKTYHX6L_ZR/_buildManifest.js" async=""></script><script src="/_next/static/UhjACfgIYlGKTYHX6L_ZR/_ssgManifest.js" async=""></script></body></html>